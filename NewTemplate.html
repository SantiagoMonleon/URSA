<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="content-type" content="text/html; charset=windows-1252">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="ISO-8859-1">
	<script>
		var FOI = location.search.substring(1).split("=")[1];
	</script>
	<script src="https://cdn.jsdelivr.net/npm/vega@3"></script>
	<script src="https://cdn.jsdelivr.net/npm/vega-lite@2"></script>
	<script src="https://cdn.jsdelivr.net/npm/vega-embed@3"></script>
	<script src="https://d3js.org/d3.v5.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
	<!-- <script>"https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.8.9/jquery.csv.js"</script> -->
	<title>Insert title here</title>
	<style>
		.row {
			display: flex;
			flex-wrap: wrap;
		}

		/* Create two unequal columns that sits next to each other */

		/* Sidebar/left column */

		.col_l {
			flex: 30%;
			/* Set the width of the sidebar */
			background-color: #f1f1f1;
			/* Grey background color */
			padding: 20px;
			/* Some padding */
		}

		/* Main column */

		.col_r {
			flex: 70%;
			/* Set the width of the main content */
			background-color: white;
			/* White background color */
			padding: 20px;
			/* Some padding */
		}

		/* Responsive layout - when the screen is less than 700px wide, make the two columns stack on top of each other instead of next to each other */

		@media screen and (max-width: 700px) {
			.row {
				flex-direction: column;
			}
		}
	</style>
</head>

<body>
	<div class="row">
		<div class="col-sm-8">
			<div class="chart-wrapper">
				<div class="chart-title">
					FOI Diameter distribution
				</div>
				<div class="chart-stage">
					<div id="report1"></div>
				</div>
				<div class="chart-notes">
					5 inches diameter classes
				</div>
			</div>
		</div>
	</div>
	<br>
	<br>
	<div class="row">
		<div class="col_l">
			<div class="chart-wrapper">
				<div class="chart-title">
					FOI aerial image
				</div>
				<div class="chart-stage">
					<iframe id="report3" scrolling="no" width="100%" height="480px" frameborder="0"></iframe>
				</div>
				<script>
					var ifrm = document.getElementById("report3");
					if (typeof (FOI) === "undefined") {
						ifrm.setAttribute("src", "../stand_overview.html");
					} else {
						ifrm.setAttribute("src", "../stand_overview.html?FOI=" + FOI);
					};
				</script>
				<div class="chart-notes">
					Aerial view
				</div>
			</div>
		</div>
		<div class="col_r">
			<div class="chart-wrapper">
				<div class="chart-title">
					Proportion of species
				</div>
				<div class="chart-stage">
					<div id="report2"></div>
				</div>
				<div class="chart-notes">
					Poportion of species as percentage of VAR
				</div>
			</div>
		</div>
	</div>
	<br>
	<div class="row">
		<div class="col-sm-6 col-md-4">
			<div class="chart-wrapper">
				<div class="chart-title">
					Proportion of Conifers-Broadleaved
				</div>
				<div class="chart-stage">
					<iframe id="report4" width="100%" height="480px" frameborder="0" scrolling="no"></iframe>
				</div>
				<div class="chart-notes">
					Conifer-Broad leaved composition
				</div>
			</div>
		</div>
	</div>
	<br>
	<br>
	<div class="row">
		<div class="col-sm-6 col-md-4">
			<div class="chart-wrapper">
				<div class="chart-title">
					Proportion of Conifers-Broadleaved
				</div>
				<div class="chart-stage">
					<iframe id="figure4">Here goes the table with the tree list</iframe>
				</div>
				<div class="chart-notes">
					Conifer-Broad leaved composition
				</div>
			</div>
		</div>
	</div>
	<script src="report1/report1.js"></script>
	<script>
		var data1 = [];
		var data2 = [];
		var dbh = [];
		var vol = [];
		var sps = [];
		var cont = 0;
		var embedopts = {
			"actions": {
				"export": { "svg": true, "png": false },
				"source": false,
				"compiled": false,
				"editor": false
			}
		};

		d3.csv("report1/FVS_" + FOI + ".csv", function (data) {
			dbh.push(+data.DBH);
			vol.push(+data.Tree_Count);
			sps.push(data.Species);
		});

		function modifyspec(spec, newdata) {
			spec.data[0]["values"] = newdata;
			return (spec);
		};
		// spec1 = modifyspec(spec1, data1);
		// vegaEmbed(
		// 	'#report1',
		// 	spec1,
		// 	{ defaultStyle: true }
		// );
		var loader = new vega.loader();
		loader.load("report1/FVS_" + FOI + ".csv").then(function (csv_data) {
			data2 = vega.read(csv_data, { type: 'csv', parse: 'auto' });
			spec1 = modifyspec(spec1, data2);
			vegaEmbed('#report1', spec1, embedopts);
		});
		var traces = [];
		var species2 = sps.filter(function(x, i, a){return a.indexOf(x) == i});
		
		for (var i = 0; i < species2.length; i++) {
			var result = {
				type: 'box',
				x : dbh[i],
				y : vol[i],
				name: species2[i],
				boxpoints: 'all',
				jitter: 0.5,
				whiskerwidth: 0.2,
				fillcolor: 'cls',
				marker: {
					size: 2
				},
				line: {
					width: 1
				}
			};
			traces.push(result);
		};

		var trace = {
			histfunc: "count",
			x: dbh,
			y: vol,
			type: 'histogram',
		};
		var data = [trace];
		Plotly.newPlot('report2', data);
	</script>
	<!-- To replace with report 2 -->
	<!-- <script src="report1/report1.js"></script>
	<script>
			var data;
			function modifyspec(spec, newdata) {
				spec.data[0]["values"] = newdata;
				return (spec);
			}
			var loader= new vega.loader();
			loader.load("report1/FVS_" + FOI + ".csv").then(function(csv_data) {
				data = vega.read(csv_data, {type: 'csv', parse: 'auto'});
				spec1 = modifyspec(spec1, data);
				var embedopts = {"actions" : {
				   "export": {"svg":true,"png":false},
				"source": false,
				"compiled": false,
				"editor": false }};
				vegaEmbed('#figure1',spec1,embedopts);
	
			});	
	</script> -->
	<!-- To replace with report 3 -->
	<!-- <script src="report1/report1.js"></script>
	<script>
			var data;
			function modifyspec(spec, newdata) {
				spec.data[0]["values"] = newdata;
				return (spec);
			}
			var loader= new vega.loader();
			loader.load("report1/FVS_" + FOI + ".csv").then(function(csv_data) {
				data = vega.read(csv_data, {type: 'csv', parse: 'auto'});
				spec1 = modifyspec(spec1, data);
				var embedopts = {"actions" : {
				   "export": {"svg":true,"png":false},
				"source": false,
				"compiled": false,
				"editor": false }};
				vegaEmbed('#figure1',spec1,embedopts);
	
			});	
	</script> -->
</body>

</html>